(function(t){function e(e){for(var o,r,i=e[0],c=e[1],u=e[2],l=0,d=[];l<i.length;l++)r=i[l],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&d.push(a[r][0]),a[r]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);m&&m(e);while(d.length)d.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],o=!0,r=1;r<n.length;r++){var i=n[r];0!==a[i]&&(o=!1)}o&&(s.splice(e--,1),t=c(c.s=n[0]))}return t}var o={},r={app:0},a={app:0},s=[];function i(t){return c.p+"js/"+({}[t]||t)+"."+{"chunk-270d5242":"4aca9a5b"}[t]+".js"}function c(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(t){var e=[],n={"chunk-270d5242":1};r[t]?e.push(r[t]):0!==r[t]&&n[t]&&e.push(r[t]=new Promise((function(e,n){for(var o="css/"+({}[t]||t)+"."+{"chunk-270d5242":"b83ff8c4"}[t]+".css",a=c.p+o,s=document.getElementsByTagName("link"),i=0;i<s.length;i++){var u=s[i],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===o||l===a))return e()}var d=document.getElementsByTagName("style");for(i=0;i<d.length;i++){u=d[i],l=u.getAttribute("data-href");if(l===o||l===a)return e()}var m=document.createElement("link");m.rel="stylesheet",m.type="text/css",m.onload=e,m.onerror=function(e){var o=e&&e.target&&e.target.src||a,s=new Error("Loading CSS chunk "+t+" failed.\n("+o+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=o,delete r[t],m.parentNode.removeChild(m),n(s)},m.href=a;var p=document.getElementsByTagName("head")[0];p.appendChild(m)})).then((function(){r[t]=0})));var o=a[t];if(0!==o)if(o)e.push(o[2]);else{var s=new Promise((function(e,n){o=a[t]=[e,n]}));e.push(o[2]=s);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=i(t);var d=new Error;u=function(e){l.onerror=l.onload=null,clearTimeout(m);var n=a[t];if(0!==n){if(n){var o=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+o+": "+r+")",d.name="ChunkLoadError",d.type=o,d.request=r,n[1](d)}a[t]=void 0}};var m=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(e)},c.m=t,c.c=o,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)c.d(n,o,function(e){return t[e]}.bind(null,o));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/",c.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var d=0;d<u.length;d++)e(u[d]);var m=l;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var o=n("85ec"),r=n.n(o);r.a},"2cf8":function(t,e,n){"use strict";var o=n("c001"),r=n.n(o);r.a},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},a=[],s=(n("034f"),n("2877")),i={},c=Object(s["a"])(i,r,a,!1,null,null,null),u=c.exports,l=(n("d3b7"),n("8c4f")),d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[t.connected?t._e():n("LoginForm"),t.connected?n("Comments"):t._e(),t.connected?n("Header"):t._e(),t.connected?n("NewPost"):t._e(),t.connected?n("Posts"):t._e()],1)},m=[],p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper"},[n("img",{staticClass:"img",attrs:{src:"/assets/img/icon.png",alt:"Groupomania logo"}}),n("nav",[n("router-link",{staticClass:"active",attrs:{to:"/"}},[t._v("Se connecter")]),t._v(" | "),n("router-link",{attrs:{to:"/signup"}},[t._v("S'inscrire")])],1),n("form",{on:{submit:function(e){return e.preventDefault(),t.login()}}},[n("label",{attrs:{for:"login-email"}},[t._v("Email :")]),n("input",{attrs:{id:"login-email",type:"text",placeholder:"Email",required:""}}),n("label",{attrs:{for:"login-password"}},[t._v("Mot de passe :")]),n("input",{attrs:{id:"login-password",type:"password",placeholder:"Mot de passe",required:""}}),n("div",{staticClass:"error-message"},[t._v(t._s(t.message))]),n("button",{attrs:{id:"login-btn",type:"submit"}},[t._v("Connexion")])])])},f=[],h=n("bc3a"),v=n.n(h),g={name:"LoginForm",data:function(){return{message:""}},methods:{login:function(){var t=this,e=document.getElementById("login-email").value,n=document.getElementById("login-password").value;v.a.post("".concat(this.$apiUrl,"/auth/login"),{email:e,password:n},{headers:{"Content-Type":"application/json"}}).then((function(t){localStorage.setItem("user",JSON.stringify(t.data)),location.reload()})).catch((function(e){404===e.response.status&&(t.message="Utilisateur inconnu."),401===e.response.status&&(t.message="Email ou mot de passe invalide."),500===e.response.status&&(t.message="Erreur serveur.")}))}}},y=g,_=(n("85d7"),Object(s["a"])(y,p,f,!1,null,"17e48bd0",null)),b=_.exports,C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"posts"},t._l(t.posts,(function(e){return n("article",{key:e.id,staticClass:"post"},[n("div",{staticClass:"post-header"},[n("span",{staticClass:"post-info"},[t._v("Posté le "+t._s(t.dateFormat(e.date))+" par "+t._s(e.prenom)+" "+t._s(e.nom))]),n("router-link",{attrs:{to:{name:"Post",params:{id:e.id}}}},[e.userId==t.$user.userId||1==t.$user.admin?n("span",{staticClass:"post-modify"},[t._v("Modifier")]):t._e()])],1),n("h2",{staticClass:"post-title"},[t._v(t._s(e.title))]),n("div",{staticClass:"post-content",domProps:{innerHTML:t._s(t.characterLimit(e.content))}})])})),0)},w=[],P={name:"Posts",data:function(){return{posts:[],visible:!1}},mounted:function(){void 0!=localStorage.user&&this.getAllPost()},methods:{getAllPost:function(){var t=this;v.a.get("".concat(this.$apiUrl,"/posts/"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.$token)}}).then((function(e){t.posts=e.data}))},characterLimit:function(t){var e=t,n=350;return e.length>n?e.substring(0,n-3)+"...":e},dateFormat:function(t){var e=new Date(t),n={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"};return e.toLocaleDateString("fr-FR",n)}}},$=P,k=(n("2cf8"),Object(s["a"])($,C,w,!1,null,"5864e82a",null)),O=k.exports,S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"header"},[n("router-link",{attrs:{to:"/"}},[n("h1",[n("img",{attrs:{src:"/assets/img/icon.png",alt:"Groupomania logo"}})])]),n("nav",[n("div",{attrs:{id:"disconnect-btn"},on:{click:function(e){return t.disconnect()}}},[t._v("Se déconnecter")])])],1)},j=[],E={name:"Header",methods:{disconnect:function(){localStorage.removeItem("user"),location.href="/"}}},x=E,A=(n("e74d"),Object(s["a"])(x,S,j,!1,null,"4a89597d",null)),I=A.exports,T=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"newPost"},[n("div",{staticClass:"newPost-create-btn",on:{click:function(e){t.visible=!0}}},[t._v("Ajouter un post")]),n("transition",{attrs:{name:"fade"}},[t.visible?n("div",{staticClass:"overlay"},[n("div",{staticClass:"form-wrapper"},[n("span",{staticClass:"form-close",on:{click:function(e){t.visible=!1}}},[t._v("Fermer")]),n("form",{staticClass:"newPost-form",on:{submit:function(e){return e.preventDefault(),t.sendNewPost()}}},[n("label",{attrs:{for:"newPost-title"}},[t._v("Titre")]),n("input",{attrs:{id:"newPost-title",type:"text",placeholder:"Titre de votre post...",required:""}}),n("label",{attrs:{for:"newPost-content"}},[t._v("Contenu")]),n("input",{attrs:{id:"newPost-content",type:"text",placeholder:"Contenu de votre post...",required:""}}),n("button",{attrs:{id:"newPost-btn",type:"submit"}},[t._v("Publier")])])])]):t._e()])],1)},L=[],B={name:"NewPost",data:function(){return{visible:!1,content:""}},methods:{sendNewPost:function(){var t=document.getElementById("newPost-title").value,e=document.getElementById("newPost-content").value;console.log(e),v.a.post("".concat(this.$apiUrl,"/posts/"),{userId:this.$user.userId,title:t,content:e},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.$token)}}).then(this.visible=!1).then(this.$root.$emit("Posts"))}}},N=B,U=(n("93af"),Object(s["a"])(N,T,L,!1,null,"438465a4",null)),F=U.exports,z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"Comments"},[n("form",{on:{submit:function(e){return e.preventDefault(),t.newComment()}}},[n("label",{attrs:{for:"new-comment"}},[t._v("Laisser un commentaire :")]),n("textarea",{attrs:{name:"newComment",id:"new-comment",placeholder:"Laisser un commentaire...",required:""}}),n("button",{attrs:{type:"submit",id:"send-comment"}},[t._v("Envoyer")])]),t.comments.length>0?n("h2",[t._v("Commentaires :")]):t._e(),n("div",{staticClass:"comments"},t._l(t.comments,(function(e){return n("div",{key:e.id,staticClass:"comment"},[n("div",{staticClass:"comment-info"},[t._v("Par "+t._s(e.prenom)+" "+t._s(e.nom)+" le "+t._s(t.dateFormat(e.date))+" "),e.userId==t.$user.userId||1==t.$user.admin?n("span",{key:e.id,on:{click:function(n){return t.deleteComment(e.id)}}},[t._v("Supprimer")]):t._e()]),t._v(" "+t._s(e.content)+" ")])})),0)])},M=[],q=(n("99af"),{names:"Comments",data:function(){return{comments:[]}},mounted:function(){this.getAllComments()},methods:{newComment:function(){var t=parseInt(this.$route.params.id),e=this.$user.userId,n=document.getElementById("new-comment").value;v.a.post("".concat(this.$apiUrl,"/comments/").concat(t,"/comment/"),{userId:e,content:n},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.$token)}}).then(this.getAllComments())},getAllComments:function(){var t=this,e=parseInt(this.$route.params.id);v.a.get("".concat(this.$apiUrl,"/comments/").concat(e,"/comments"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.$token)}}).then((function(e){t.comments=e.data}))},deleteComment:function(t){v.a.delete("".concat(this.$apiUrl,"/comments/comment/").concat(t),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.$token)}}).then(this.getAllComments())},dateFormat:function(t){var e=new Date(t),n={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"};return e.toLocaleDateString("fr-FR",n)}}}),D=q,H=(n("cc51"),Object(s["a"])(D,z,M,!1,null,"65a1cf17",null)),J=H.exports,G={name:"Home",components:{LoginForm:b,Posts:O,Header:I,NewPost:F,Comments:J},data:function(){return{connected:!0}},created:function(){this.checkConnected()},methods:{checkConnected:function(){void 0!==localStorage.user?this.connected=!0:void 0==localStorage.user&&(this.connected=!1)}}},R=G,K=Object(s["a"])(R,d,m,!1,null,null,null),Q=K.exports,V=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"post"},[t.connected?t._e():n("LoginForm"),t.connected?n("Header"):t._e(),t.connected?n("OnePost"):t._e()],1)},W=[],X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"onePost"},[n("div",{staticClass:"modify-wrapper"},[n("label",{attrs:{for:"modify-title"}},[t._v("Modifier le titre :")]),n("input",{directives:[{name:"model",rawName:"v-model",value:this.post.title,expression:"this.post.title"}],attrs:{type:"text",id:"modify-title"},domProps:{value:this.post.title},on:{input:function(e){e.target.composing||t.$set(this.post,"title",e.target.value)}}}),n("label",{attrs:{for:"modify-content"}},[t._v("Modifier le contenu :")]),n("input",{directives:[{name:"model",rawName:"v-model",value:this.post.content,expression:"this.post.content"}],attrs:{id:"modify-content"},domProps:{value:this.post.content},on:{input:function(e){e.target.composing||t.$set(this.post,"content",e.target.value)}}})]),n("button",{on:{click:function(e){return t.modifyOnePost()}}},[t._v("Publier les modifications")]),n("button",{staticClass:"delete-btn",on:{click:function(e){return t.deleteOnePost()}}},[t._v("Supprimer le post")])])},Y=[],Z={name:"OnePost",data:function(){return{modifiedContent:"",post:[],authorized:!1,modify:!1}},mounted:function(){this.getOnePost()},methods:{getOnePost:function(){var t=this,e=this.$route.params.id;v.a.get("".concat(this.$apiUrl,"/posts/").concat(e),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.$token)}}).then((function(e){t.post=e.data[0],t.$user.userId===t.post.userId||1==t.$user.admin?t.authorized=!0:t.authorized=!1}))},deleteOnePost:function(){var t=this.$route.params.id;v.a.delete("".concat(this.$apiUrl,"/posts/").concat(t),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.$token)}}).then(location.href="/")},modifyOnePost:function(){var t=this.$route.params.id,e=document.querySelector("#modify-title").value,n=document.querySelector("#modify-content").value;v.a.put("".concat(this.$apiUrl,"/posts/").concat(t),{postId:t,title:e,content:n},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.$token)}}).then(location.href="/")}}},tt=Z,et=(n("dc88"),Object(s["a"])(tt,X,Y,!1,null,"5ffbab64",null)),nt=et.exports,ot={name:"Post",components:{Header:I,LoginForm:b,OnePost:nt},data:function(){return{connected:!0,authorized:!0}},methods:{checkConnected:function(){void 0!==localStorage.user?(this.connected=!0,console.log("Utilisateur connecté !")):void 0==localStorage.user&&(this.connected=!1,console.log("Utilisateur non connecté !"))}},created:function(){this.checkConnected()}},rt=ot,at=Object(s["a"])(rt,V,W,!1,null,null,null),st=at.exports;o["a"].use(l["a"]);var it=[{path:"/",name:"Home",component:Q},{path:"/post/:id",name:"Post",component:st},{path:"/Comment",name:"Comment",component:Comment},{path:"/signup",name:"Signup",component:function(){return n.e("chunk-270d5242").then(n.bind(null,"34c3"))}}],ct=new l["a"]({mode:"history",routes:it}),ut=ct;o["a"].config.productionTip=!1,o["a"].prototype.$apiUrl="http://localhost:3000/api",void 0!=localStorage.user&&(o["a"].prototype.$token=JSON.parse(localStorage.user).token,o["a"].prototype.$user=JSON.parse(localStorage.user)),new o["a"]({router:ut,render:function(t){return t(u)}}).$mount("#app")},5988:function(t,e,n){},"635a":function(t,e,n){},"77af":function(t,e,n){},"85d7":function(t,e,n){"use strict";var o=n("5988"),r=n.n(o);r.a},"85ec":function(t,e,n){},"8afa":function(t,e,n){},"93af":function(t,e,n){"use strict";var o=n("c843"),r=n.n(o);r.a},c001:function(t,e,n){},c843:function(t,e,n){},cc51:function(t,e,n){"use strict";var o=n("635a"),r=n.n(o);r.a},dc88:function(t,e,n){"use strict";var o=n("8afa"),r=n.n(o);r.a},e74d:function(t,e,n){"use strict";var o=n("77af"),r=n.n(o);r.a}});
//# sourceMappingURL=app.116b8cc9.js.map